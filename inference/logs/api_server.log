2025-11-26 10:19:23,122 - base.py - 49 - WARNING - Tool `retrieval` already exists! Overwriting with class <class 'tool_retrieval.Retrieval'>.
2025-11-26 10:19:23 - __main__ - INFO - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: INFO
/mnt/data6t/wangxiaojing/tongyi_deepresearch/DeepResearch-openevidence/inference/api_server.py:137: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
2025-11-26 10:19:23 - __main__ - INFO - ğŸ”§ å¯åŠ¨é…ç½®:
2025-11-26 10:19:23 - __main__ - INFO -    APIç«¯å£: 5006
2025-11-26 10:19:23 - __main__ - INFO -    vLLMç«¯å£: 6001
2025-11-26 10:19:23 - __main__ - INFO -    æ¨¡å‹è·¯å¾„: /mnt/data6t/wangxiaojing/models/opensource_models/Alibaba-NLP/Tongyi-DeepResearch-30B-A3B
2025-11-26 10:19:23 - api_server - INFO - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: INFO
INFO:     Started server process [582703]
INFO:     Waiting for application startup.
2025-11-26 10:19:23 - api_server - INFO - ğŸš€ å¯åŠ¨Tongyi DeepResearch APIæœåŠ¡å™¨...
2025-11-26 10:19:23 - api_server - INFO - âœ… æ¨ç†ä»£ç†é…ç½®æ¨¡æ¿åˆå§‹åŒ–å®Œæˆ
2025-11-26 10:19:23 - api_server - INFO - ğŸ“¡ LLM APIåœ°å€: https://dashscope.aliyuncs.com/compatible-mode/v1
2025-11-26 10:19:23 - api_server - INFO - ğŸ¤– æ¨¡å‹: qwen3-32b
2025-11-26 10:19:23 - api_server - INFO - ğŸ”‘ API Key (masked): sk-56e045b...76260
2025-11-26 10:19:23 - api_server - INFO - ğŸŒ APIæœåŠ¡å™¨å°†åœ¨ç«¯å£ 5006 ä¸Šè¿è¡Œ
2025-11-26 10:19:23 - api_server - INFO - ğŸ”’ å¹¶å‘æ§åˆ¶: æœ€å¤§å¹¶å‘è¯·æ±‚æ•° = 3
2025-11-26 10:19:23 - api_server - INFO - ğŸ’¡ æç¤º: å¯é€šè¿‡ç¯å¢ƒå˜é‡ MAX_CONCURRENT_REQUESTS è°ƒæ•´å¹¶å‘æ•°
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5006 (Press CTRL+C to quit)
INFO:     127.0.0.1:34282 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:19549 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:38822 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:57063 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:57062 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:2562 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:43252 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-26 10:19:46 - api_server - INFO - ğŸ“ åˆ›å»ºæ–°ä¼šè¯: f9347752...
INFO:     10.31.95.28:7994 - "GET /api/sessions/new HTTP/1.1" 200 OK
2025-11-26 10:19:46 - api_server - INFO - ğŸ“ åˆ›å»ºæ–°ä¼šè¯: ae2885b6...
INFO:     10.31.95.28:13711 - "GET /api/sessions/new HTTP/1.1" 200 OK
INFO:     10.31.95.28:27282 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:47476 - "POST /chat/stream HTTP/1.1" 200 OK
2025-11-26 10:19:49 - api_server - INFO - â³ [Session a6b043e7] ç­‰å¾…è·å–å¤„ç†æ§½ä½... (å½“å‰æ´»è·ƒ: 0)
2025-11-26 10:19:49 - api_server - INFO - ğŸš€ [Session a6b043e7] è·å–æ§½ä½æˆåŠŸï¼Œå¼€å§‹å¤„ç†é—®é¢˜: ç”·æ€§ï¼Œ52å²ã€‚ ä¸»è¯‰è…¹ç—›ã€æ¶å¿ƒã€å‘•å1å¤©ã€‚ ç°ç—…å²æ‚£è€…1å¤©å‰çªå‘ä¸Šè…¹ç—›ï¼Œä¼´æ¶å¿ƒï¼Œå‘•åèƒƒå†…å®¹ç‰©ã€‚å‘•åå...
2025-11-26 10:19:49 - streaming_agent - INFO - === StreamingReactAgent.stream_run START ===
2025-11-26 10:19:49 - streaming_agent - INFO - ğŸ§  å·²å¯ç”¨æ€è€ƒæ¨¡å¼ (thinking_budget=1000)
2025-11-26 10:19:50 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:20:07 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ€è€ƒè¿‡ç¨‹å®Œæˆï¼Œè€—æ—¶: 17.76 ç§’
INFO:     10.31.95.28:4505 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:4506 - "GET /health HTTP/1.1" 200 OK
2025-11-26 10:20:22 - streaming_agent - INFO - âœ… æµå¼è°ƒç”¨æˆåŠŸ - æ€è€ƒ: 636å­—, å›ç­”: 626å­—
2025-11-26 10:20:22 - streaming_agent - INFO - ğŸš€ æ£€æµ‹åˆ° 3 ä¸ªå·¥å…·è°ƒç”¨ï¼Œå¼€å§‹å¹¶å‘æ‰§è¡Œ
2025-11-26 10:20:25 - streaming_agent - INFO - ğŸ” å¹¶å‘æ£€ç´¢è°ƒç”¨ 3/3 å®Œæˆï¼Œå…³é”®è¯: ç³–å°¿ç—…é…®ç—‡é…¸ä¸­æ¯’
2025-11-26 10:20:28 - streaming_agent - INFO - ğŸ” å¹¶å‘æ£€ç´¢è°ƒç”¨ 1/3 å®Œæˆï¼Œå…³é”®è¯: ç³–å°¿ç—…é…®ç—‡é…¸ä¸­æ¯’ è¡¥æ¶² èƒ°å²›ç´ 
2025-11-26 10:20:29 - streaming_agent - INFO - ğŸ” å¹¶å‘æ£€ç´¢è°ƒç”¨ 2/3 å®Œæˆï¼Œå…³é”®è¯: ç³–å°¿ç—…é…®ç—‡é…¸ä¸­æ¯’ è¡€ç³–æ§åˆ¶
2025-11-26 10:20:29 - streaming_agent - INFO - âœ… åˆå¹¶äº† 3 ç»„æ£€ç´¢ç»“æœ
2025-11-26 10:20:29 - api_server - WARNING - âš ï¸ [Session a6b043e7] å‘é€å¤§æ•°æ®åŒ…: 19056 å­—èŠ‚, ç±»å‹: retrieval_combined
2025-11-26 10:20:30 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:20:36 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ£€ç´¢ç»“æœè¯„ä¼°å®Œæˆï¼Œè€—æ—¶: 7.24 ç§’
2025-11-26 10:20:36 - answer_system - INFO - ğŸ“ å‡†å¤‡ç­”æ¡ˆç”Ÿæˆå†…å®¹: 14378 å­—ç¬¦, 23 æ¡æ£€ç´¢ç»“æœ
2025-11-26 10:20:36 - answer_system - INFO - ğŸš€ å¼€å§‹è°ƒç”¨ç­”æ¡ˆç”ŸæˆAPI (æ¨¡å‹: qwen3-max)
2025-11-26 10:20:40 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:20:40 - answer_system - INFO - âš¡ æ”¶åˆ°é¦–ä¸ªtokenï¼Œè€—æ—¶: 4.47ç§’
INFO:     10.31.95.28:7514 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:11213 - "GET /health HTTP/1.1" 200 OK
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“š ç­”æ¡ˆä¸­å¼•ç”¨çš„refç¼–å·ï¼ˆæŒ‰é¦–æ¬¡å‡ºç°é¡ºåºï¼‰: ['ref01', 'ref02', 'ref03', 'ref04']
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“ ç­”æ¡ˆæ–‡æœ¬æ›¿æ¢å®Œæˆï¼Œå…±æ›¿æ¢ 8 å¤„
2025-11-26 10:21:11 - answer_system - INFO - âœ… æ›¿æ¢æˆåŠŸï¼šåŸå§‹æ–‡æœ¬é•¿åº¦ 1457, æ›¿æ¢åé•¿åº¦ 1369
2025-11-26 10:21:11 - answer_system - INFO - âœ… æˆåŠŸæ›¿æ¢äº†ç­”æ¡ˆä¸­çš„refç¼–å·
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“š æœ€ç»ˆä½¿ç”¨çš„å‚è€ƒæ–‡çŒ®æ•°é‡: 4/23
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“š refåˆ°retrievalçš„æ˜ å°„å…³ç³»: {'ref01': 'retrieval_21', 'ref02': 'retrieval_01', 'ref03': 'retrieval_05', 'ref04': 'retrieval_04'}
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“š æœ€ç»ˆä½¿ç”¨çš„å‚è€ƒæ–‡çŒ®refç¼–å·: ['ref01', 'ref02', 'ref03', 'ref04']
2025-11-26 10:21:11 - answer_system - INFO - ğŸ“š æœ€ç»ˆä½¿ç”¨çš„å‚è€ƒæ–‡çŒ®retrievalç¼–å·: ['retrieval_21', 'retrieval_01', 'retrieval_05', 'retrieval_04']
2025-11-26 10:21:11 - streaming_agent - INFO - âœ… ä½¿ç”¨æ›¿æ¢åçš„ç­”æ¡ˆæ–‡æœ¬ï¼ˆrefç¼–å·å·²æ›¿æ¢ä¸ºæ•°å­—ç¼–å·ï¼‰
2025-11-26 10:21:11 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æœ€ç»ˆç­”æ¡ˆç”Ÿæˆå®Œæˆï¼Œè€—æ—¶: 35.15 ç§’
2025-11-26 10:21:11 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ•´ä¸ªæµç¨‹å®Œæˆï¼Œæ€»è€—æ—¶: 81.75 ç§’
2025-11-26 10:21:11 - streaming_agent - INFO - === StreamingReactAgent.stream_run COMPLETED (FROM RETRIEVAL) ===
2025-11-26 10:21:11 - api_server - INFO - ğŸ’¾ [Session a6b043e7] å·²ä¿å­˜å¯¹è¯å†å²ï¼ˆç”¨æˆ·é—®é¢˜ + æœ€ç»ˆç­”æ¡ˆï¼‰
2025-11-26 10:21:11 - api_server - INFO - âœ… [Session a6b043e7] å¤„ç†å®Œæˆï¼Œé‡Šæ”¾æ§½ä½
2025-11-26 10:21:11 - api_server - INFO - âœ… [Session a6b043e7] ä¼šè¯æ­£å¸¸å®Œæˆ
2025-11-26 10:21:11 - api_server - INFO - ğŸ”“ [Session a6b043e7] æ§½ä½å·²é‡Šæ”¾
INFO:     10.31.95.28:11209 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:11210 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:1423 - "GET /citation/1 HTTP/1.1" 200 OK
INFO:     10.31.95.28:2742 - "GET /citation/2 HTTP/1.1" 200 OK
INFO:     10.31.95.28:27115 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:27116 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:19492 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:19493 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:50798 - "GET /citation/3 HTTP/1.1" 200 OK
INFO:     10.31.95.28:8354 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:8355 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:57309 - "GET /citation/2 HTTP/1.1" 200 OK
INFO:     10.31.95.28:3389 - "GET /citation/4 HTTP/1.1" 200 OK
INFO:     10.31.95.28:4712 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:4713 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:11345 - "GET /citation/3 HTTP/1.1" 200 OK
INFO:     10.31.95.28:51188 - "GET /citation/2 HTTP/1.1" 200 OK
INFO:     10.31.95.28:56385 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:56386 - "GET /health HTTP/1.1" 200 OK
