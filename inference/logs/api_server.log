2025-10-31 14:59:49,173 - base.py - 49 - WARNING - Tool `retrieval` already exists! Overwriting with class <class 'tool_retrieval.Retrieval'>.
2025-10-31 14:59:49 - __main__ - INFO - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: INFO
/mnt/data6t/wangxiaojing/tongyi_deepresearch/DeepResearch-openevidence/inference/api_server.py:137: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
2025-10-31 14:59:49 - __main__ - INFO - ğŸ”§ å¯åŠ¨é…ç½®:
2025-10-31 14:59:49 - __main__ - INFO -    APIç«¯å£: 5006
2025-10-31 14:59:49 - __main__ - INFO -    vLLMç«¯å£: 6001
2025-10-31 14:59:49 - __main__ - INFO -    æ¨¡å‹è·¯å¾„: /mnt/data6t/wangxiaojing/models/opensource_models/Alibaba-NLP/Tongyi-DeepResearch-30B-A3B
2025-10-31 14:59:49 - api_server - INFO - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: INFO
INFO:     Started server process [4139411]
INFO:     Waiting for application startup.
2025-10-31 14:59:49 - api_server - INFO - ğŸš€ å¯åŠ¨Tongyi DeepResearch APIæœåŠ¡å™¨...
2025-10-31 14:59:49 - api_server - INFO - âœ… æ¨ç†ä»£ç†é…ç½®æ¨¡æ¿åˆå§‹åŒ–å®Œæˆ
2025-10-31 14:59:49 - api_server - INFO - ğŸ“¡ LLM APIåœ°å€: https://dashscope.aliyuncs.com/compatible-mode/v1
2025-10-31 14:59:49 - api_server - INFO - ğŸ¤– æ¨¡å‹: qwen3-32b
2025-10-31 14:59:49 - api_server - INFO - ğŸ”‘ API Key (masked): sk-f59e9bf...f991e
2025-10-31 14:59:49 - api_server - INFO - ğŸŒ APIæœåŠ¡å™¨å°†åœ¨ç«¯å£ 5006 ä¸Šè¿è¡Œ
2025-10-31 14:59:49 - api_server - INFO - ğŸ”’ å¹¶å‘æ§åˆ¶: æœ€å¤§å¹¶å‘è¯·æ±‚æ•° = 3
2025-10-31 14:59:49 - api_server - INFO - ğŸ’¡ æç¤º: å¯é€šè¿‡ç¯å¢ƒå˜é‡ MAX_CONCURRENT_REQUESTS è°ƒæ•´å¹¶å‘æ•°
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5006 (Press CTRL+C to quit)
INFO:     127.0.0.1:57146 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:53676 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:53677 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:40063 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:40064 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:13451 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:13452 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:33960 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:33961 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:34573 - "GET /citation/8 HTTP/1.1" 404 Not Found
INFO:     10.31.95.28:27046 - "GET /citation/6 HTTP/1.1" 404 Not Found
INFO:     10.31.95.28:54517 - "GET /citation/4 HTTP/1.1" 404 Not Found
INFO:     10.31.95.28:39760 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:39759 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:5829 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:29197 - "GET /api/sessions HTTP/1.1" 200 OK
2025-10-31 15:01:45 - api_server - INFO - ğŸ“ åˆ›å»ºæ–°ä¼šè¯: 3ee1354e...
INFO:     10.31.95.28:8570 - "GET /api/sessions/new HTTP/1.1" 200 OK
2025-10-31 15:01:46 - api_server - INFO - ğŸ“ åˆ›å»ºæ–°ä¼šè¯: a15b670e...
INFO:     10.31.95.28:8571 - "GET /api/sessions/new HTTP/1.1" 200 OK
INFO:     10.31.95.28:8572 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:8573 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:5031 - "OPTIONS /chat/stream HTTP/1.1" 200 OK
INFO:     10.31.95.28:5032 - "POST /chat/stream HTTP/1.1" 200 OK
2025-10-31 15:01:47 - api_server - INFO - â³ [Session db41ee7c] ç­‰å¾…è·å–å¤„ç†æ§½ä½... (å½“å‰æ´»è·ƒ: 0)
2025-10-31 15:01:47 - api_server - INFO - ğŸš€ [Session db41ee7c] è·å–æ§½ä½æˆåŠŸï¼Œå¼€å§‹å¤„ç†é—®é¢˜: ç”·æ€§ï¼Œ52å²ã€‚ ä¸»è¯‰è…¹ç—›ã€æ¶å¿ƒã€å‘•å1å¤©ã€‚ ç°ç—…å²æ‚£è€…1å¤©å‰çªå‘ä¸Šè…¹ç—›ï¼Œä¼´æ¶å¿ƒï¼Œå‘•åèƒƒå†…å®¹ç‰©ã€‚å‘•åå...
2025-10-31 15:01:48 - streaming_agent - INFO - === StreamingReactAgent.stream_run START ===
2025-10-31 15:01:48 - streaming_agent - INFO - ğŸ§  å·²å¯ç”¨æ€è€ƒæ¨¡å¼ (thinking_budget=1000)
2025-10-31 15:01:48 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-31 15:02:00 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ€è€ƒè¿‡ç¨‹å®Œæˆï¼Œè€—æ—¶: 12.42 ç§’
2025-10-31 15:02:02 - streaming_agent - INFO - âœ… æµå¼è°ƒç”¨æˆåŠŸ - æ€è€ƒ: 667å­—, å›ç­”: 186å­—
2025-10-31 15:02:02 - streaming_agent - INFO - ğŸ” ç¬¬ 1 è½®æ£€ç´¢ï¼Œå…³é”®è¯: ç³–å°¿ç—…é…®ç—‡ è¡¥æ¶² èƒ°å²›ç´ æ²»ç–— æŒ‡å—
2025-10-31 15:02:05 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ£€ç´¢å·¥å…·æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: 2.90 ç§’
2025-10-31 15:02:06 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-31 15:02:12 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ£€ç´¢ç»“æœè¯„ä¼°å®Œæˆï¼Œè€—æ—¶: 7.02 ç§’
2025-10-31 15:02:12 - answer_system - INFO - ğŸ“ å‡†å¤‡ç­”æ¡ˆç”Ÿæˆå†…å®¹: 5200 å­—ç¬¦, 8 æ¡æ£€ç´¢ç»“æœ
2025-10-31 15:02:12 - answer_system - INFO - ğŸš€ å¼€å§‹è°ƒç”¨ç­”æ¡ˆç”ŸæˆAPI (æ¨¡å‹: qwen3-max)
INFO:     10.31.95.28:5563 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:5564 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:4509 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:4510 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:32055 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:32056 - "GET /health HTTP/1.1" 200 OK
2025-10-31 15:03:21 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-31 15:03:21 - answer_system - INFO - âš¡ æ”¶åˆ°é¦–ä¸ªtokenï¼Œè€—æ—¶: 68.99ç§’
INFO:     10.31.95.28:31109 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:31110 - "GET /health HTTP/1.1" 200 OK
2025-10-31 15:04:14 - answer_system - INFO - ğŸ“š ç­”æ¡ˆä¸­å¼•ç”¨çš„ç¼–å·: [1, 2, 3, 5, 6]
2025-10-31 15:04:14 - answer_system - INFO - ğŸ“š é¢„ç”Ÿæˆçš„å‚è€ƒæ–‡çŒ®ID: [1, 2, 3, 4, 5, 6, 7, 8]
2025-10-31 15:04:14 - answer_system - INFO - ğŸ“š æœ€ç»ˆä½¿ç”¨çš„å‚è€ƒæ–‡çŒ®æ•°é‡: 5/8
2025-10-31 15:04:14 - answer_system - INFO - ğŸ“š æœ€ç»ˆä½¿ç”¨çš„å‚è€ƒæ–‡çŒ®ID: [1, 2, 3, 5, 6]
2025-10-31 15:04:14 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æœ€ç»ˆç­”æ¡ˆç”Ÿæˆå®Œæˆï¼Œè€—æ—¶: 121.94 ç§’
2025-10-31 15:04:14 - streaming_agent - INFO - â±ï¸  ã€æ—¶é—´ç»Ÿè®¡ã€‘æ•´ä¸ªæµç¨‹å®Œæˆï¼Œæ€»è€—æ—¶: 146.50 ç§’
2025-10-31 15:04:14 - streaming_agent - INFO - === StreamingReactAgent.stream_run COMPLETED (FROM RETRIEVAL) ===
2025-10-31 15:04:14 - api_server - INFO - ğŸ’¾ [Session db41ee7c] å·²ä¿å­˜å¯¹è¯å†å²ï¼ˆç”¨æˆ·é—®é¢˜ + æœ€ç»ˆç­”æ¡ˆï¼‰
2025-10-31 15:04:14 - api_server - INFO - âœ… [Session db41ee7c] å¤„ç†å®Œæˆï¼Œé‡Šæ”¾æ§½ä½
2025-10-31 15:04:14 - api_server - INFO - âœ… [Session db41ee7c] ä¼šè¯æ­£å¸¸å®Œæˆ
2025-10-31 15:04:14 - api_server - INFO - ğŸ”“ [Session db41ee7c] æ§½ä½å·²é‡Šæ”¾
INFO:     10.31.95.28:34455 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:34456 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:11060 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:11061 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:57787 - "GET /citation/6 HTTP/1.1" 200 OK
INFO:     10.31.95.28:54058 - "GET /citation/1 HTTP/1.1" 200 OK
INFO:     10.31.95.28:9397 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:3819 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:16108 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:16109 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:26898 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:26899 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:8970 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:8971 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:48606 - "GET /citation/2 HTTP/1.1" 200 OK
INFO:     10.31.95.28:12803 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:12804 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:10461 - "GET /citation/3 HTTP/1.1" 200 OK
INFO:     10.31.95.28:55499 - "GET /citation/5 HTTP/1.1" 200 OK
INFO:     10.31.95.28:23596 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:23597 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:7275 - "GET /citation/6 HTTP/1.1" 200 OK
INFO:     10.31.95.28:40648 - "GET /health HTTP/1.1" 200 OK
INFO:     10.31.95.28:40647 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:4186 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     10.31.95.28:4187 - "GET /health HTTP/1.1" 200 OK
